<!--
    Geometric Modeling: Subdivision and Decimation demo
    by Adam Badke
    adambadke@gmail.com
-->

<!DOCTYPE html>
<html lang="en">

    <head>
            <meta charset="utf-8">
            <link rel="stylesheet" href="./style.css" type="text/css">

            <title>Geometric Modeling: Subdivision and Decimation demo</title>

            <!-- Shared/global values: -->
            <script type="text/javascript" src="./scripts/shared.js"></script>
            
            <!-- Helpers: -->
			<script type="text/javascript" src="./scripts/shaders.js"></script>
            <script type="text/javascript" src="./scripts/mesh.js"></script>
            <script type="text/javascript" src="./scripts/renderObjects.js"></script>
            <script type="text/javascript" src="./scripts/sceneObjects.js"></script>

            <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"
                integrity="sha512-zhHQR0/H5SEBL3Wn6yYSaTTZej12z0hVZKOv3TwCUXT1z5qeqGcXJLLrbERYRScEDDpYIJhPC1fk31gqR783iQ=="
                crossorigin="anonymous" defer>
            </script>

            <!-- Main program: -->
            <script src="./scripts/mainProgram.js" defer></script>            

    </head>

    <body oncontextmenu="return false;"> <!-- Disable the context menu to prevent popups when dragging right mouse -->
        <canvas id="glCanvas" width="640" height="480"></canvas>


        <p>Please open your browser's debug console to see program output.</p>


        <h3>Mesh Selection:</h3>

		<div class="buttonGroup">
			<button onclick="loadOBJ(document.getElementById('urlInput').value)">Load mesh file</button>

			<label for="urlInput" id="urlInputLabel" >Mesh .OBJ URL:</label>
			<input type="text" id="urlInput" value="https://gist.githubusercontent.com/MaikKlein/0b6d6bb58772c13593d0a0add6004c1c/raw/48cf9c6d1cdd43cc6862d7d34a68114e2b93d497/cube.obj" >
		</div>
		
		<p></p>
        <div class="buttonGroup">
			
            <button onclick="downloadOBJ(document.getElementById('filenameInput').value)">Download mesh file</button>

			<label for="filenameInput" id="filenameInputLabel" >File name:</label>
			<input type="text" id="filenameInput" value="result.obj" >
        </div>

        <br>

        <h3>Mesh Display:</h3>

        <div class="buttonGroup">
            <button onclick="setActiveShadingMode(0)">Flat Shading</button>
            <button onclick="setActiveShadingMode(1)">Smooth Shading</button>
			<button onclick="setActiveShadingMode(2)">Wireframe Shading</button>
            <button onclick="setActiveShadingMode(3)">Smooth + Wireframe Shading</button>
        </div>

		<br>

		<h3>Mesh Subdivision:</h3>
		<div>
			<label for="subdivisionType">Choose subdivision scheme:</label>
			<select name="subdivisionDropdown" id="subdivisionType">
				<option value="0">Loop</option>
				<option value="1">Butterfly</option>
			</select>

			<br>

			<label for="subdivisionSlider" id="subdivisionSliderLabel">Number of subdivision iterations: 1</label>

			<input name="numSubdivisionsSlider" id="subdivisionSlider" type="range" min="1" max="5" step="1" value="1" class="slider" oninput="document.getElementById('subdivisionSliderLabel').innerHTML = 'Number of subdivision iterations: ' + this.value">

			<div class="buttonGroup">
				<button onclick="subdivideMesh(document.getElementById('subdivisionType').value, document.getElementById('subdivisionSlider').value)">Subdivide!</button>
			</div>
		</div>

		<h3>Mesh Decimation:</h3>
		<div>
			<label for="decimationText" id="decimationTextLabel">Number of edges to collapse:</label>
			<input name="numDecimatedEdgesText" id="decimationText" type="text" value="1">

			<br>

			<label for="kText" id="kTextLabel">Number of random edges to consider per operation (k):</label>
			<input name="numKText" id="kText" type="text" value="8">

			<div class="buttonGroup">
				<button onclick="decimateMesh(document.getElementById('decimationText').value, document.getElementById('kText').value)">Decimate!</button>
			</div>
		</div>

        <br>

        <h3>Controls:</h3>
		<div>
			<style type="text/css">
				.tg  {border-collapse:collapse;border-spacing:0;}
				.tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
				  overflow:hidden;padding:10px 5px;word-break:normal;}
				.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
				  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
				.tg .tg-1wig{font-weight:bold;text-align:left;vertical-align:top}
				.tg .tg-0lax{text-align:left;vertical-align:top}
				</style>
				<table class="tg">
				<thead>
				  <tr>
					<th class="tg-1wig">Left click:</th>
					<th class="tg-0lax">Rotate about X/Y</th>
				  </tr>
				</thead>
				<tbody>
				  <tr>
					<td class="tg-1wig">Middle click:</td>
					<td class="tg-0lax">Uniform scale</td>
				  </tr>
				  <tr>
					<td class="tg-1wig">Right click:</td>
					<td class="tg-0lax">Translate</td>
				  </tr>
				</tbody>
				</table>
		</div>

        <!-- Index values representing the transform type passed here must match the values defined in ./scripts/shared.js -->
		<br>
        <h4>Non-uniform Scale:</h4>
        <div class="slideContainer">
			<label for="mesh_scale_x" id="mesh_scale_x_label" >X:</label>
            <input id="mesh_scale_x" type="range" min="0.01" max="5" step="0.1" value="1" class="slider" oninput="updateMeshTransform(6, this.value)">
        </div>

        <div class="slideContainer">
			<label for="mesh_scale_y" id="mesh_scale_y_label" >Y:</label>
            <input id="mesh_scale_y" type="range" min="0.01" max="5" step="0.1" value="1" class="slider" oninput="updateMeshTransform(7, this.value)">
        </div>

        <div class="slideContainer">
			<label for="mesh_scale_z" id="mesh_scale_z_label" >Z:</label>
            <input id="mesh_scale_z" type="range" min="0.01" max="5" step="0.1" value="1" class="slider" oninput="updateMeshTransform(8, this.value)">
        </div>


    </body>


</html>